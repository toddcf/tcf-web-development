<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- Headings -->
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
  <!-- Body -->
  <link href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="../assets/prism/prism-okaidia-1.29.0.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/global-min.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/font-sizes-min.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/nav-min.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/headings-min.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/martech-article.css">
  <link rel="stylesheet" type="text/css" href="../assets/css/footer-min.css">
  
  <title>MarTech | Adobe Launch Global Click or Event Tracking</title>

  <meta name="Author" content="Todd Croak-Falen">
  <meta name="Description" content="MarTech Adobe Launch Global Click or Event Tracking.">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
  <link rel="manifest" href="../manifest.json">
  <link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="../favicon.ico">
  <meta name="msapplication-config" content="browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

</head>

<body class="body line-numbers">

  <div class="body__project-container">

    <nav class="nav">
      <div class="center__1140 nav__flex">
        <a href="/" class="nav__flex_link font_size_1">
          <div class="nav__flex_text"><i class="fas fa-home nav__flex_icon"></i>Home</div>
        </a>
        <a href="../about-me" class="nav__flex_link font_size_1">
          <div class="nav__flex_text"><i class="fas fa-user-circle nav__flex_icon"></i>About Me</div>
        </a>
        <!-- <a href="../resume_todd_croak-falen.pdf" target="_blank" class="nav__flex_link font_size_1">
          <div class="nav__flex_text"><i class="fas fa-file-alt nav__flex_icon"></i>Résumé</div>
        </a> -->
      </div> <!-- Close .nav__flex -->
    </nav>

    <main class="main content-top">

      <header class="header">
        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h1 class="heading__title-tag font_size_4">
              <span class="heading__title-tag_title">Adobe Launch Global Click or Event Tracking</span>
            </h1>
          </div>
        </div>
        <div class="martech-header__img martech-header__img_swimming-pool-water-overhead"></div>
      </header>

      <section>

        <div class="heading heading_theme_black">
          <div class="heading__title-overflow">
            <h2 class="heading__title-tag font_size_3">
              <span class="heading__title-tag_title">Overview</span>
            </h2>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">
          
            <p class="main__text font_size_body">At my company, there is a core set of tracking events and variables we send to Adobe Analytics for all events.</p>

            <p class="main__text font_size_body">For the purposes of this explanation, let&rsquo;s say I work at a solar power company. (All variables and attributes in this article have been changed to suit that scenario.) To keep things D.R.Y., this core set of variables is programmed into one Adobe Launch rule named <code class="code__name">Global | Set Variables | Clicks or Events #25</code>, which fires on every event we want to track.</p>

            <p class="main__text font_size_body">In addition to those baseline variables, if that event is a click, we also send:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">event1: Custom Link Click (increment)</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">eVar1: Custom Link Value (describes which element was clicked)</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">prop1: Custom Link Value (same value as eVar1)</p>
              </li>
            </ul>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">Basic Custom Link Values</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">The Custom Link Value that gets passed into eVar1 and prop1 is typically a concatenation of two data attributes, which we put into each element we want to track clicks on:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-noun (represents &ldquo;what&rdquo; is being clicked)</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-verb (represents the &ldquo;action&rdquo; the user is taking)</p>
              </li>
            </ul>

            <p class="main__text font_size_body">These two values get concatenated, colon-delimited, and assigned to eVar1 and prop1. For example, if we had a &ldquo;Careers&rdquo; card containing a &ldquo;Learn More&rdquo; button, that button would contain:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-noun="careers"</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-verb="learn-more"</p>
              </li>
            </ul>

            <p class="main__text font_size_body">(We standardize these values to lowercase kebab-case.) The resulting value passed in eVar1 and prop1 would be <code class="code__name">careers:learn-more</code>.</p>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">Accordion &lsquo;Open&rsquo; vs. &lsquo;Close&rsquo;</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">Sometimes it gets more complex than this. Maybe there is an FAQ page containing a list of questions. Each question is an accordion that can be opened or closed by clicking on it, and we want to know which is occurring.</p>

            <p class="main__text font_size_body">In this case, we would append a value of &lsquo;open&rsquo; or &lsquo;close&rsquo; to eVar1 and prop1:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">faq:who-installs-your-panels:open</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">faq:who-installs-your-panels:close</p>
              </li>
            </ul>

            <p class="main__text font_size_body">This, too, requires custom logic to only append such a value if the situation calls for it.</p>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">Nested AEM Components</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">Even more complex is if we have AEM components nested inside each other in any order and any combination you might imagine. (See my article on Adobe Launch Nested AEM Component Click Tracking for details.)</p>

            <p class="main__text font_size_body">For example, our Careers page has three sections:</p>

            <ol class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">Employment</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Apprenticeships</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Internships</p>
              </li>
            </ol>

            <p class="main__text font_size_body">Within each of these sections there is a set of cards, each representing a category. For example, the &ldquo;Employment&rdquo; section contains these cards:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">Administration</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Research & Development</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Sales</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Installation & Repair</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Support</p>
              </li>
            </ul>

            <p class="main__text font_size_body">And each card contains two buttons:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">Learn More</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">View Jobs</p>
              </li>
            </ul>

            <p class="main__text font_size_body">If a user clicks a &ldquo;Learn More&rdquo; button and all we pass is <code class="code__name">learn-more</code>, that won&rsquo;t tell us much about which careers are getting the most clicks. Instead, we want values like:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">employment:research-development:learn-more</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">employment:installation-repair:view-jobs</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">employment:administration:learn-more</p>
              </li>
            </ul>

            <p class="main__text font_size_body">This requires more than just our standard two <code class="code__name">data-track-noun</code> and <code class="code__name">data-track-verb</code> attributes. In cases like this, we will have:</p>

            <ul class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-component-level-1="employment"</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-noun="research-development"</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">data-track-verb="learn-more"</p>
              </li>
            </ul>

            <p class="main__text font_size_body">And the three of those need to get concatenated, in the right order, and only if they exist. In addition, there could be multiple levels of parent components. We could have <code class="code__name">data-track-component-level-1</code>, <code class="code__name">2</code>, <code class="code__name">3</code>, etc. So even more custom logic is required to account for those use cases.</p>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">Shadow DOM Clicks</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">All of the above needs to work the same way if a user clicks an element inside a shadow DOM. (For example, our global header and footer are each inside a shadow DOM.)</p>

            <p class="main__text font_size_body">As of this writing, Adobe Launch does not detect clicks in shadow DOMs, so we have to simulate those by passing the clicked element into this rule via direct call object.  (See my article on <a href="adobe-launch-shadow-dom-click-tracking">Adobe Launch Shadow DOM Click Tracking</a> for how this is accomplished.)</p>

            <p class="main__text font_size_body">So, this <code class="code__name">Global | Set Variables | Clicks or Events #25</code> rule needs to be able to take in that object, treat it as if it were a regular clicked element, and then account for all the same use cases listed above.</p>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->
        
      </section>

      <section>

        <div class="heading heading_theme_black">
          <div class="heading__title-overflow">
            <h2 class="heading__title-tag font_size_3">
              <span class="heading__title-tag_title">Create the <b>Global | Set Variables | Clicks or Events #25</b> Rule</span>
            </h2>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">
            
            <p class="main__text font_size_body">This is the rule that will contain a lot of custom code. Here is the full code block for context. (Scroll past it for a breakdown of what it does.) MOVE THIS TO THE LATER SECTION WHEN IT'S CREATED.</p>

  <pre class="code__block"><code class="language-javascript">// Code will go here once generalized.</code></pre>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">Explanation</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">First, we will create the "Set Variables" rule and do its basic configuration.</p>

            <ol class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">Create a Launch rule. You'll of course use whatever naming conventions your library already follows, but let's say it's called <code class="code__name">Global | Set Variables | Clicks or Events #25</code>.</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Set the rule to fire on clicks for all anchor tags and buttons.</p>
                <ol class="main__list font_size_body">
                  <li class="content__block_li">
                    <p class="main__text font_size_body">Create a new Event.</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Extension" dropdown, select "Core."</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Event Type" dropdown, select "Click."</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">Select the "specific elements" radio button.</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Elements matching the CSS selector" field, type: <code class="code__name">a, button</code></p>
                  </li>
                </ol>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">Also set the rule to fire when certain direct calls are received.</p>
                <ol class="main__list font_size_body">
                  <li class="content__block_li">
                    <p class="main__text font_size_body">Create another new Event.</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Extension" dropdown, select "Core."</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Event Type" dropdown, select "Direct Call."</p>
                  </li>
                  <li class="content__block_li">
                    <p class="main__text font_size_body">In the "Identifier" field, type: <code class="code__name">set-global-click-or-event-variables</code></p>
                  </li>
                </ol>
              </li>
              <!-- <li class="content__block_li">
                <p class="main__text font_size_body">Placeholder for HTML structure when pre tag should be used:</p>
                <pre class="code__block"><code class="code__snippet font_size_body">// Code would go here.</code></pre>
              </li> -->
            </ol>

            <p class="main__text font_size_body">The next step for this rule would be to write the custom code that collects and concatenates all the click-tracking values. But for now let's save this rule and set up its counterpart, the <code class="code__name">Global | Send Beacon, Clear Variables | Clicks or Events #100</code> rule.</p>

            <p class="main__text font_size_body">Now it's time to write the custom code that will collect and concatenate our click tracking values.</p>

            <ol class="main__list font_size_body">
              <li class="content__block_li">
                <p class="main__text font_size_body">Create a new Action. In the "Extension" dropdown, select "Adobe Analytics."</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">In the "Action Type" dropdown, select "Set Variables."</p>
              </li>
              <li class="content__block_li">
                <p class="main__text font_size_body">In the panel that opens to the right, scroll to the bottom and click "Open Editor." This is where your custom code will go.</p>
              </li>
            </ol>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

        <div class="heading heading_theme_clear">
          <div class="heading__title-overflow">
            <h3 class="heading__title-tag font_size_2">
              <span class="heading__title-tag_title">How to Use the <b>Global | Clicks or Events</b> Rules</span>
            </h3>
          </div>
        </div>

        <div class="content__center content__center_700">

          <div class="content__block">

            <p class="main__text font_size_body">The rule is now ready to listen for . . .</p>
            <p class="main__text font_size_body">See my Adobe Launch Shadow DOM Click Tracking article for details on how to pass clicked elements from the shadow DOM into this rule.</p>

          </div> <!-- Close .content__block -->

        </div> <!-- Close .content__center content__center_700 -->

      </section>
    
    </main>

    <footer class="footer footer_theme_black">

      <div class="center__1140">
      
        <div class="footer__icon-row">

          <div class="footer__icon">
            <a href="/" class="footer__icon_link">
              <div class="footer__icon_link-content">
                <i class="fas fa-home footer__icon_icon"></i>
                <p class="footer__icon_text font_size_body">Home</p>
              </div>
            </a>
          </div>

          <div class="footer__icon">
            <a href="https://www.github.com/toddcf" target="_blank" class="footer__icon_link">
              <div class="footer__icon_link-content">
                <i class="fab fa-github footer__icon_icon"></i>
                <p class="footer__icon_text font_size_body">GitHub</p>
              </div>
            </a>
          </div>

          <div class="footer__icon">
            <a href="https://www.linkedin.com/in/toddcf" target="_blank" class="footer__icon_link">
              <div class="footer__icon_link-content">
                <i class="fab fa-linkedin footer__icon_icon"></i>
                <p class="footer__icon_text font_size_body">LinkedIn</p>
              </div>
            </a>
          </div>

          <div class="footer__icon">
            <a href="resume_todd_croak-falen.pdf" target="_blank" class="footer__icon_link">
              <div class="footer__icon_link-content">
                <i class="fas fa-file-alt footer__icon_icon"></i>
                <p class="footer__icon_text font_size_body">Résumé</p>
                <p class="footer__icon_text font_size_body">(PDF with contact info)</p>
              </div>
            </a>
          </div>
          
        </div> <!-- Close .footer-icon__row -->

        <div class="footer__copyright">
          <p class="footer__copyright_text font_size_body">&copy; Copyright 2016 <span class="currentYear"></span>Todd Croak-Falen</p>
        </div>

      </div> <!-- Close .center__1140 -->

    </footer>

  </div> <!-- Close .body__project-container -->

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

  <!-- Waypoints -->
  <script src="../assets/js/jquery.waypoints.min.js"></script>

  <!-- Prism -->
  <script src="../assets/prism/prism-okaidia-1.29.0.js"></script>
  
  <!-- Custom JavaScript -->
  <script src="../assets/js/global.js"></script>
  <script src="../assets/js/footer-min.js"></script>

</body>

</html>