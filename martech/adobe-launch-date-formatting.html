<!doctype html><html lang=en><meta charset=utf-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><link href=https://use.fontawesome.com/releases/v5.8.1/css/all.css rel=stylesheet crossorigin=anonymous integrity=sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf><link href=https://fonts.googleapis.com rel=preconnect><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=PT+Sans:wght@400;700&display=swap" rel=stylesheet><link href=../assets/prism/prism-okaidia-1.29.0.css rel=stylesheet><link href=../assets/css/global-min.css rel=stylesheet><link href=../assets/css/text-min.css rel=stylesheet><link href=../assets/css/nav-min.css rel=stylesheet><link href=../assets/css/heading-min.css rel=stylesheet><link href=../assets/css/martech-article-min.css rel=stylesheet><link href=../assets/css/footer-min.css rel=stylesheet><title>MarTech | Adobe Launch Date Formatting</title><meta content="Todd Croak-Falen" name=Author><meta content="Adobe Launch date formatting." name=Description><link href=../apple-touch-icon.png rel=apple-touch-icon sizes=180x180><link href=../favicon-32x32.png rel=icon sizes=32x32 type=image/png><link href=../favicon-16x16.png rel=icon sizes=16x16 type=image/png><link href=../manifest.json rel=manifest><link href=../safari-pinned-tab.svg rel=mask-icon color=#5bbad5><link href=../favicon.ico rel="shortcut icon"><meta content=browserconfig.xml name=msapplication-config><meta content=#ffffff name=theme-color><body class="body line-numbers"><div class=body__project-container><nav class=nav><div class="center__1140 nav__flex"><a class="font_size_1 nav__flex_link" href=/ ><div class=nav__flex_text><i class="fas nav__flex_icon fa-home"></i>Home</div></a><a class="font_size_1 nav__flex_link" href=../about-me><div class=nav__flex_text><i class="fas nav__flex_icon fa-user-circle"></i>About Me</div></a></div></nav><div class="breadcrumbs breadcrumbs_theme_white content-top"><div class="content__center content__center_1440"><p class="font_size_body breadcrumbs__text"><a class="breadcrumbs__text link link_theme_black" href=/ >Home</a> <span class=breadcrumbs__text>></span> <a class="breadcrumbs__text link link_theme_black" href=../martech>MarTech</a> <span class=breadcrumbs__text>></span> <span class=breadcrumbs__text>Adobe Launch Date Formatting</span></div></div><main class=main><header class=header><div class="heading heading_theme_clear"><div class=heading__title-overflow><h1 class="heading__title-tag font_size_4"><span class=heading__title-tag_title>Adobe Launch Date Formatting</span></h1></div></div><div class="martech-header__img martech-header__img_canyon-night-sky"></div></header><section><div class="heading heading_theme_black"><div class=heading__title-overflow><h2 class="heading__title-tag font_size_3"><span class=heading__title-tag_title>Overview</span></h2></div></div><div class="content__center content__center_700"><div class=content__block><p class="font_size_body text__main">One issue I faced at my job was that the data layer contained different date formats in different site sections — and sometimes in different portions of the same site section. For the purposes of this example, let’s say I work on an airline website, and that early in the booking flow, the departure date is in the <code class=language-javascript>'MM/DD/YY'</code> format. But later in the booking flow, that same date is in the <code class=language-javascript>'YYYY-MM-DD'</code> format.<p class="font_size_body text__main">Adobe Analytics wants to receive the <code class=language-javascript>'YYYY-MM-DD'</code> format, which means that the lower funnel is fine . . . but the upper funnel would need some custom logic to reformat it.<p class="font_size_body text__main">To further complicate matters, one of our marketing pixels wants that same date in the <code class=language-javascript>'MM/DD/YYYY'</code> (four-digit year) format.<p class="font_size_body text__main">The solution:<ol class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Standardize the data layer so that all dates are JavaScript <em>date objects</em> instead of strings, giving us the most versatility to reformat any way we like from there.<li class=content__block_li><p class="font_size_body text__main">Create a set of Adobe Launch data elements that can take in a JavaScript date object and return it in a predetermined format. (One data element per desired format — one that returns a <code class=language-javascript>'YYYY-MM-DD'</code> string, one that returns a <code class=language-javascript>'MM/DD/YYYY'</code> string, etc.)</ol></div></div></section><section><div class="heading heading_theme_black"><div class=heading__title-overflow><h2 class="heading__title-tag font_size_3"><span class=heading__title-tag_title>Date-Formatting Syntax</span></h2></div></div><div class="content__center content__center_700"><div class=content__block><p class="font_size_body text__main">I’ll use the <code class=language-javascript>'YYYY-MM-DD'</code> format as my example. The name of this data element will be <code class=language-javascript>date | YYYY-MM-DD format</code>.<p class="font_size_body text__main">The first thing to mention is that <em>you can pass one data element into another</em>. I didn’t know that at first, and it was one of those discoveries that kind of blew my mind. I had been thinking of data elements as variables, since that was how we’d been using them, but they are really more like functions — they return a value. And, optionally, they can take in an argument and do something with it before returning that value.<p class="font_size_body text__main">Here is our data element’s full syntax. (Scroll past to see an explanation of each code block.)</div></div><div class="content__center content__center_1140"><pre class="code__block"><code class="language-javascript">const inputDate = event;
let outputYYYYMMDD = (!!inputDate) ? inputDate : '';
const formattedDateArr = [];

const formatYYYYMMDD = (singleDateObj) => {
  let yyyy = 'YYYY';
  let mm = 'MM';
  let dd = 'DD';
  if (typeof singleDateObj.getMonth === 'function') {
    yyyy = singleDateObj.getFullYear();
    mm = singleDateObj.getMonth() + 1;
    mm = (mm < 10) ? '0' + mm : mm;
    dd = singleDateObj.getDate();
    dd = (dd < 10) ? '0' + dd : dd;
  }
  return yyyy + '-' + mm + '-' + dd;
}

if (!!inputDate) {
  if (Array.isArray(inputDate)) {
    // If inputDate is an array:
    if (inputDate.length > 0 && typeof inputDate[0].getMonth === 'function') {
      inputDate.forEach((dateObj) => {
        if (typeof dateObj.getMonth === 'function') {
          formattedDateArr.push(formatYYYYMMDD(dateObj));
        }
      });
      outputYYYYMMDD = (formattedDateArr.length > 0) ? formattedDateArr.join() : '';
    } else {
      outputYYYYMMDD = '';
    }
  } else if (typeof inputDate.getMonth === 'function') {
    // If inputDate is an individual date object:
    outputYYYYMMDD = formatYYYYMMDD(inputDate);
  } else if (typeof inputDate === 'string' && inputDate !== 'any') {
    outputYYYYMMDD = '';
  }
}

return outputYYYYMMDD;</code></pre><div class="heading heading_theme_clear"><div class=heading__title-overflow><h3 class="heading__title-tag font_size_2"><span class=heading__title-tag_title>Explanation</span></h3></div></div><div class="content__center content__center_700"><div class=content__block><ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 1: <code class=language-javascript>event</code> represents the argument that was passed into this data element. For the most part, we will expect this to be a JavaScript date object. (Although, as you will see later in this flow, that is not the only use case, and we have plenty of logic to confirm the data type before we start calling methods on it that could throw an error.) We store it in <code class=language-javascript>inputDate</code>.<li class=content__block_li><p class="font_size_body text__main">Line 2: As the name implies, <code class=language-javascript>outputYYYYMMDD</code> is the <code class=language-javascript>let</code> that we will be returning at the end. But we set a default value up top, because there are some non-date-object use cases to account for — hence the ternary:<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">First, the value pulled from the data layer may be <code class=language-javascript>'any'</code> — a string, not a date object. This is the default value if the user is at the top of the booking funnel and has not filtered for a specific date (or range of dates) yet.<li class=content__block_li><p class="font_size_body text__main">Second, something may have gone wrong in the data layer, and something like <code class=language-javascript>null</code> or <code class=language-javascript>undefined</code> or <code class=language-javascript>'NA'</code> has been passed into our data element. If so, we default to an empty string.</ul><li class=content__block_li><p class="font_size_body text__main">Line 3: Create an empty array for use cases where multiple dates are being handled. (The user may be filtering for a range of departure dates.)<li class=content__block_li><p class="font_size_body text__main">Lines 5 - 19: Create a reusable function that takes in a date object and returns it in the <code class=language-javascript>'YYYY-MM-DD'</code> string format. (The whole point of this particular data element.)<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Lines 6 - 8: Set string defaults. This way, if only part of the logic has a problem, you can easily see which part.<li class=content__block_li><p class="font_size_body text__main">Lines 9 - 15: Parse the date object and store each piece (year, month, day) in its respective variable.<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 11: Add <code class=language-javascript>+1</code> to the month, since JavaScript months start at <code class=language-javascript>0</code>, and we don’t want all the data we send to Analytics to be off by one month.<li class=content__block_li><p class="font_size_body text__main">Lines 12 - 14: Prepend a <code class=language-javascript>0</code> to any single-digit month or day values.</ul><li class=content__block_li><p class="font_size_body text__main">Line 16: Return the date as a string in the <code class=language-javascript>'YYYY-MM-DD'</code> format. <em>(NOTE: If you want this data element to return some other format, such as <code class=language-javascript>'MM/DD/YYYY'</code>, this is the line to edit.)</em></ul><li class=content__block_li><p class="font_size_body text__main">Line 19: Once again, use validation to confirm that something was actually passed in before attempting to run the rest of this logic on it.<li class=content__block_li><p class="font_size_body text__main">Lines 20 - 31: Use Case 1 – We have taken in an <em>array</em> of date objects and need to convert them into one string in the <code class=language-javascript>'YYYY-MM-DD,YYYY-MM-DD,YYYY-MM-DD'</code> format.<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Lines 22 - 28: If the array contains date objects:<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 22: Confirm that we’re dealing with an array, that it contains at least one item, and that at least the first item is a JavaScript date object.<li class=content__block_li><p class="font_size_body text__main">Lines 23 - 27: Loop over the array and format each date object into a <code class=language-javascript>'YYYY-MM-DD'</code> string.<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 24: Validation to confirm that each item is in fact a date object.<li class=content__block_li><p class="font_size_body text__main">Line 25: Format each date (using the <code class=language-javascript>formatYYYYMMDD</code> function we created up top), and then push it into our <code class=language-javascript>formattedDateArr</code> array.</ul><li class=content__block_li><p class="font_size_body text__main">Line 28: After that process is complete, if the <code class=language-javascript>formattedDateArr</code> contains at least one item, join it with the default delimiter — commas — and store it in our <code class=language-javascript>outputYYYYMMDD</code> variable to be returned at the end. Otherwise, set it to an empty string. (NOTE: Do <em>not</em> encode the commas.)</ul><li class=content__block_li><p class="font_size_body text__main">Lines 29 - 31: If the array contains items other than date objects, set our final value to an empty string. (Remember, we are preemptively accounting for breakages in the data layer.)</ul><li class=content__block_li><p class="font_size_body text__main">Lines 32 - 34: Use Case 2 – We have taken in an <em>individual</em> date object, and need to convert it into a string formatted like <code class=language-javascript>'YYYY-MM-DD'</code>.<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 34: This one’s much simpler — just pass the date object into our <code class=language-javascript>formatYYYYMMDD</code> function we created up top, and store the result in <code class=language-javascript>outputYYYYMMDD</code>.</ul><li class=content__block_li><p class="font_size_body text__main">Lines 35 - 37: Use Case 3 – We have taken in a string (other than <code class=language-javascript>'any'</code>), and need to wipe it.<ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">Line 36: We have had recurring issues in our data layer where a date object somehow gets converted to a string. If this happens, we report it to that development team, and they fix it. But in the meantime, we want to wipe those strings so that we don’t start passing odd values. Especially to AEP, which is very finicky about expected values and data types.</ul><li class=content__block_li><p class="font_size_body text__main">Line 40: Return the final value. Note that Use Case 4 would be that an <code class=language-javascript>'any'</code> string would have passed straight through this flow unscathed and been returned as the final value.</ul></div></div><section><div class="heading heading_theme_black"><div class=heading__title-overflow><h2 class="heading__title-tag font_size_3"><span class=heading__title-tag_title>Data Element Argument Syntax</span></h2></div></div><div class="content__center content__center_700"><div class=content__block><p class="font_size_body text__main">The <code class=language-javascript>date | YYYY-MM-DD format</code> data element is ready. Now I can pass anything you want into it — I’m not even limited to the departure date. It could be an arrival date, the current date, anything. It could even be the wrong data type, and our validation will prevent it from throwing a ton of errors.<p class="font_size_body text__main">But let’s say I do want to pass the departure date into it, and that data element is simply titled <code class=language-javascript>departure date</code>. I just use <code class=language-javascript>_satellite.getVar()</code> to retrieve each one, and pass the <code class=language-javascript>departure date</code> data element into the <code class=language-javascript>date | YYYY-MM-DD format</code> data element. Like this:</div></div><div class="content__center content__center_1140"><div class=content__block><pre class=code__block><code class=language-javascript>_satellite.getVar('date | YYYY-MM-DD format', _satellite.getVar('departure date'));</code></pre></div></div><div class="content__center content__center_700"><div class=content__block><ul class="font_size_body list__main"><li class=content__block_li><p class="font_size_body text__main">If it went in as a single date object, it will come out as a string, like <code class=language-javascript>'2024-02-01'</code>.<li class=content__block_li><p class="font_size_body text__main">If it went in as an array of date objects, it will come out as a comma-delimited string of <code class=language-javascript>YYYY-MM-DD</code> dates, like <code class=language-javascript>'2024-02-01,2024-02-02,2024-02-03'</code>.<li class=content__block_li><p class="font_size_body text__main">If it went in as an <code class=language-javascript>'any'</code> string, it will emerge intact as an <code class=language-javascript>'any'</code> string.<li class=content__block_li><p class="font_size_body text__main">And if it went in as any other data type, or falsy value, it will emerge as an empty string.</ul></div></div></section></main><footer class="footer footer_theme_black"><div class=center__1140><div class=footer__icon-row><div class=footer__icon><a class=footer__icon_link href=/ ><div class=footer__icon_link-content><i class="footer__icon_icon fas fa-home"></i><p class="font_size_body footer__icon_text">Home</div></a></div><div class=footer__icon><a class=footer__icon_link href=https://www.github.com/toddcf target=_blank><div class=footer__icon_link-content><i class="footer__icon_icon fab fa-github"></i><p class="font_size_body footer__icon_text">GitHub</div></a></div><div class=footer__icon><a class=footer__icon_link href=https://www.linkedin.com/in/toddcf target=_blank><div class=footer__icon_link-content><i class="footer__icon_icon fab fa-linkedin"></i><p class="font_size_body footer__icon_text">LinkedIn</div></a></div><div class=footer__icon><a class=footer__icon_link href=resume_todd_croak-falen.pdf target=_blank><div class=footer__icon_link-content><i class="footer__icon_icon fas fa-file-alt"></i><p class="font_size_body footer__icon_text">Résumé<p class="font_size_body footer__icon_text">(PDF with contact info)</div></a></div></div><div class=footer__copyright><p class="font_size_body footer__copyright_text">© Copyright 2016 <span class=currentYear></span>Todd Croak-Falen</div></div></footer><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js crossorigin=anonymous integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo></script><script src=../assets/js/jquery.waypoints.min.js></script><script src=../assets/prism/prism-okaidia-1.29.0.js></script><script src=../assets/js/global-min.js></script><script src=../assets/js/footer-min.js></script>